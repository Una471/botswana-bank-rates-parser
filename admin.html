<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Bank Rates Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 2em;
        }

        .logout-btn {
            padding: 10px 25px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: white;
            color: #667eea;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
        }

        .upload-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .upload-section h2 {
            margin-bottom: 20px;
        }

        .upload-zone {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 60px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-zone:hover {
            background: rgba(102, 126, 234, 0.05);
            border-color: #764ba2;
        }

        .upload-zone.dragover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #764ba2;
        }

        .upload-icon {
            font-size: 4em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #999;
        }

        #fileInput {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
            margin-top: 20px;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .recent-uploads {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .recent-uploads h2 {
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
        }

        .status-processing {
            background: #fff3cd;
            color: #856404;
        }

        .manual-entry-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        .notification.show {
            display: block;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
            }
            to {
                transform: translateX(0);
            }
        }
        
        .upload-instructions {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 4px solid #667eea;
        }
        
        .upload-instructions h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .upload-instructions ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .upload-instructions li {
            margin-bottom: 8px;
        }
        
        .upload-instructions .tip-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-top: 15px;
        }
        
        .test-button {
            margin-top: 15px;
            padding: 10px 20px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .test-button:hover {
            background: #e0e0e0;
        }
        
        .debug-info {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }
        
        .debug-info.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1><i class="fas fa-shield-alt"></i> Admin Dashboard</h1>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Dashboard Stats -->
        <div class="dashboard-grid">
            <div class="stat-card">
                <h3>Total Banks</h3>
                <div class="number" id="totalBanks">0</div>
            </div>
            <div class="stat-card">
                <h3>Last Upload</h3>
                <div class="number" id="lastUpload" style="font-size: 1.2em;">Never</div>
            </div>
            <div class="stat-card">
                <h3>Total Uploads</h3>
                <div class="number" id="totalUploads">0</div>
            </div>
        </div>

        <!-- PDF Upload Section -->
        <div class="upload-section">
            <h2><i class="fas fa-file-pdf"></i> Upload Bank Rate PDF</h2>
            
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                </div>
                <div class="upload-text">Drop PDF file here or click to browse</div>
                <div class="upload-subtext">Supported: PDF (Max 10MB)</div>
                <input type="file" id="fileInput" accept=".pdf">
            </div>
            
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            
            <div id="uploadStatus" style="margin-top: 20px;"></div>
            
            <button class="test-button" onclick="testWithSamplePDF()">
                <i class="fas fa-vial"></i> Test Parser with Sample
            </button>
            
            <div class="debug-info" id="debugInfo">
                <h4><i class="fas fa-bug"></i> Debug Information</h4>
                <div id="debugContent"></div>
            </div>
        </div>
        
        <!-- Upload Instructions -->
        <div class="upload-instructions">
            <h3><i class="fas fa-info-circle"></i> PDF Upload Guidelines for Collaborators</h3>
            <p>For best results when uploading bank rate PDFs:</p>
            <ul>
                <li><strong>Filename should include bank name:</strong> e.g., "FNB Rates March 2025.pdf" or "Bank Gaborone January 2025.pdf"</li>
                <li><strong>PDF must be text-based</strong> (not scanned images)</li>
                <li><strong>Required content in PDF:</strong>
                    <ul>
                        <li>Bank name clearly visible</li>
                        <li>Interest rates in percentage format (e.g., 3.50%)</li>
                        <li>Date or period information</li>
                    </ul>
                </li>
                <li><strong>Supported banks:</strong> Any bank in Botswana (FNB, Stanbic, Access Bank, Standard Chartered, Absa, Bank Gaborone, etc.)</li>
            </ul>
            
            <div class="tip-box">
                <strong><i class="fas fa-lightbulb"></i> Pro Tips:</strong>
                <ol style="margin-top: 10px; padding-left: 20px;">
                    <li>If PDF parsing fails, rename the file to include the bank name clearly</li>
                    <li>For scanned PDFs, use OCR software to convert to text first</li>
                    <li>Test with one PDF at a time to verify parsing works</li>
                    <li>Use the "Manual Rate Entry" form below as a backup option</li>
                </ol>
            </div>
        </div>

        <!-- Manual Entry Section -->
        <div class="manual-entry-section">
            <h2><i class="fas fa-keyboard"></i> Manual Rate Entry</h2>
            <p style="color: #666; margin-bottom: 20px;">Add or update bank rates manually (use if PDF upload fails)</p>
            
            <div class="form-grid">
                <div class="form-group">
                    <label>Bank Name *</label>
                    <input type="text" id="bankName" placeholder="e.g., FNB Botswana" required>
                </div>
                <div class="form-group">
                    <label>Report Period</label>
                    <input type="text" id="reportPeriod" placeholder="e.g., January 2026">
                </div>
                <div class="form-group">
                    <label>MoPR (%)</label>
                    <input type="number" id="mopr" step="0.01" placeholder="3.50">
                </div>
                <div class="form-group">
                    <label>Prime Lending Rate (%)</label>
                    <input type="number" id="primeRate" step="0.01" placeholder="7.01">
                </div>
                <div class="form-group">
                    <label>12M FD Min (%)</label>
                    <input type="number" id="fd12min" step="0.01" placeholder="5.55">
                </div>
                <div class="form-group">
                    <label>12M FD Max (%)</label>
                    <input type="number" id="fd12max" step="0.01" placeholder="6.25">
                </div>
                <div class="form-group">
                    <label>Contact Phone</label>
                    <input type="text" id="contactPhone" placeholder="316 8900">
                </div>
                <div class="form-group">
                    <label>Website</label>
                    <input type="url" id="website" placeholder="https://example.com">
                </div>
            </div>
            
            <button class="btn btn-success" onclick="submitManualEntry()" style="margin-top: 20px;">
                <i class="fas fa-save"></i> Save to Database
            </button>
            
            <button class="btn btn-info" onclick="loadSampleData()" style="margin-top: 20px; margin-left: 10px;">
                <i class="fas fa-magic"></i> Load Sample Data
            </button>
        </div>

        <!-- Recent Uploads -->
        <div class="recent-uploads">
            <h2><i class="fas fa-history"></i> Recent Uploads</h2>
            <table>
                <thead>
                    <tr>
                        <th>Date & Time</th>
                        <th>Filename</th>
                        <th>Bank Detected</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="uploadsTable">
                    <tr>
                        <td colspan="5" style="text-align: center; color: #999;">No uploads yet</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div id="notificationMessage"></div>
    </div>

    <script>
        const CONFIG = {
            AIRTABLE_API_KEY: 'patBhLP5wtc8YTY0A.30baf2ceb238a472b12ac9b5db2d366ad0f68a1f6c9363ec15ad96357339053a',
            AIRTABLE_BASE_ID: 'appHKaTJz3Bx550eb',
            AIRTABLE_TABLE_NAME: 'Bank Interest Rates',
            PDF_PARSER_ENDPOINT: 'https://rates-parser.vercel.app/api/parse-pdf'
        };

        let uploadHistory = [];

        // Upload Zone
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');

        uploadZone.addEventListener('click', () => fileInput.click());

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileUpload(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });

        async function handleFileUpload(file) {
            // Reset previous messages
            document.getElementById('uploadStatus').innerHTML = '';
            document.getElementById('debugInfo').classList.remove('show');
            
            if (file.type !== 'application/pdf') {
                showNotification('Please upload a PDF file', 'error');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                showNotification('File size must be less than 10MB', 'error');
                return;
            }

            // Show progress
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            progressBar.style.display = 'block';
            progressFill.style.width = '30%';
            progressFill.textContent = '30%';

            // Convert to base64
            const reader = new FileReader();
            reader.onload = async (e) => {
                const base64 = e.target.result.split(',')[1];
                
                try {
                    progressFill.style.width = '60%';
                    progressFill.textContent = '60%';

                    console.log('Uploading to:', CONFIG.PDF_PARSER_ENDPOINT);
                    
                    const response = await fetch(CONFIG.PDF_PARSER_ENDPOINT, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            filename: file.name,
                            content: base64
                        })
                    });

                    const result = await response.json();
                    console.log('Server response:', result);

                    progressFill.style.width = '100%';
                    progressFill.textContent = '100%';

                    if (response.ok) {
                        showNotification('PDF processed successfully! Data has been updated.', 'success');
                        addToUploadHistory(file.name, result.data['Bank Name'], 'success');
                        updateStats();
                        
                        // Show extracted data
                        const statusDiv = document.getElementById('uploadStatus');
                        statusDiv.innerHTML = `
                            <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; margin-top: 15px;">
                                <strong><i class="fas fa-check-circle"></i> Success!</strong>
                                <p>Bank: ${result.data['Bank Name']}</p>
                                <p>Period: ${result.data['Report Period'] || 'Not specified'}</p>
                                <p>12M FD Rate: ${result.data['FD 12M Nominal Min'] || 'N/A'}% - ${result.data['FD 12M Nominal Max'] || 'N/A'}%</p>
                            </div>
                        `;
                        
                        setTimeout(() => {
                            progressBar.style.display = 'none';
                            progressFill.style.width = '0%';
                        }, 2000);
                    } else {
                        // Show detailed error
                        let errorMsg = result.error || 'Upload failed';
                        if (result.details) {
                            errorMsg += ': ' + result.details;
                        }
                        
                        // Show debug info
                        const debugInfo = document.getElementById('debugInfo');
                        const debugContent = document.getElementById('debugContent');
                        debugContent.innerHTML = `
                            <p><strong>Error:</strong> ${errorMsg}</p>
                            ${result.suggestions ? `
                                <p><strong>Suggestions:</strong></p>
                                <ul>
                                    ${result.suggestions.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                            ` : ''}
                            ${result.textSample ? `
                                <p><strong>PDF Text Sample:</strong></p>
                                <div style="background: white; padding: 10px; border-radius: 5px; font-family: monospace; max-height: 200px; overflow: auto;">
                                    ${result.textSample}
                                </div>
                            ` : ''}
                        `;
                        debugInfo.classList.add('show');
                        
                        throw new Error(errorMsg);
                    }
                } catch (error) {
                    progressBar.style.display = 'none';
                    console.error('Upload error:', error);
                    
                    const statusDiv = document.getElementById('uploadStatus');
                    statusDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <strong><i class="fas fa-exclamation-triangle"></i> Upload Failed:</strong><br>
                            ${error.message}
                            <br><br>
                            <strong>Troubleshooting:</strong><br>
                            1. Rename PDF to include bank name (e.g., "FNB-rates.pdf")<br>
                            2. Ensure PDF contains text (not scanned images)<br>
                            3. Check that rates are visible in the PDF<br>
                            4. Try the manual entry form below
                        </div>
                    `;
                    
                    showNotification('Upload failed: ' + error.message.split('\n')[0], 'error');
                    addToUploadHistory(file.name, 'Unknown', 'error');
                }
            };
            reader.readAsDataURL(file);
        }

        async function submitManualEntry() {
            const bankName = document.getElementById('bankName').value.trim();
            if (!bankName) {
                showNotification('Bank Name is required', 'error');
                return;
            }

            const data = {
                'Bank Name': bankName,
                'Report Period': document.getElementById('reportPeriod').value.trim(),
                'MoPR': parseFloat(document.getElementById('mopr').value) || null,
                'Prime Lending Rate': parseFloat(document.getElementById('primeRate').value) || null,
                'FD 12M Nominal Min': parseFloat(document.getElementById('fd12min').value) || null,
                'FD 12M Nominal Max': parseFloat(document.getElementById('fd12max').value) || null,
                'Contact Phone': document.getElementById('contactPhone').value.trim(),
                'Website': document.getElementById('website').value.trim(),
                'Last Updated': new Date().toISOString().split('T')[0],
                'Data Source': 'Manual Entry'
            };

            try {
                const url = `https://api.airtable.com/v0/${CONFIG.AIRTABLE_BASE_ID}/${CONFIG.AIRTABLE_TABLE_NAME}`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${CONFIG.AIRTABLE_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ fields: data })
                });

                if (response.ok) {
                    showNotification('Data saved successfully!', 'success');
                    clearForm();
                    updateStats();
                    addToUploadHistory('Manual Entry', data['Bank Name'], 'success');
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to save data');
                }
            } catch (error) {
                showNotification('Error saving data: ' + error.message, 'error');
            }
        }

        function loadSampleData() {
            document.getElementById('bankName').value = 'FNB Botswana';
            document.getElementById('reportPeriod').value = 'March 2025';
            document.getElementById('mopr').value = '1.90';
            document.getElementById('primeRate').value = '6.01';
            document.getElementById('fd12min').value = '5.50';
            document.getElementById('fd12max').value = '6.75';
            document.getElementById('contactPhone').value = '318 5903';
            document.getElementById('website').value = 'https://www.fnbbotswana.co.bw';
            
            showNotification('Sample data loaded. Click "Save to Database" to save.', 'info');
        }

        function clearForm() {
            document.getElementById('bankName').value = '';
            document.getElementById('reportPeriod').value = '';
            document.getElementById('mopr').value = '';
            document.getElementById('primeRate').value = '';
            document.getElementById('fd12min').value = '';
            document.getElementById('fd12max').value = '';
            document.getElementById('contactPhone').value = '';
            document.getElementById('website').value = '';
        }

        function addToUploadHistory(filename, bankName, status) {
            const now = new Date();
            uploadHistory.unshift({
                date: now.toLocaleString(),
                filename,
                bankName,
                status
            });

            // Keep only last 10 uploads
            if (uploadHistory.length > 10) {
                uploadHistory = uploadHistory.slice(0, 10);
            }

            updateUploadTable();
        }

        function updateUploadTable() {
            const tbody = document.getElementById('uploadsTable');
            
            if (uploadHistory.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #999;">No uploads yet</td></tr>';
                return;
            }

            let html = '';
            uploadHistory.forEach(upload => {
                const statusClass = upload.status === 'success' ? 'status-success' : 
                                  upload.status === 'processing' ? 'status-processing' : 'status-error';
                const statusText = upload.status === 'success' ? 'Success' : 
                                 upload.status === 'processing' ? 'Processing' : 'Failed';
                
                html += `
                    <tr>
                        <td>${upload.date}</td>
                        <td>${upload.filename}</td>
                        <td>${upload.bankName}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="btn btn-primary" style="padding: 5px 15px; font-size: 0.85em;" onclick="viewUploadDetails('${upload.filename}')">
                                <i class="fas fa-eye"></i> View
                            </button>
                        </td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;
        }

        function viewUploadDetails(filename) {
            const upload = uploadHistory.find(u => u.filename === filename);
            if (upload) {
                alert(`Upload Details:\n\nFilename: ${upload.filename}\nBank: ${upload.bankName}\nStatus: ${upload.status}\nDate: ${upload.date}`);
            }
        }

        async function updateStats() {
            try {
                const url = `https://api.airtable.com/v0/${CONFIG.AIRTABLE_BASE_ID}/${CONFIG.AIRTABLE_TABLE_NAME}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${CONFIG.AIRTABLE_API_KEY}`
                    }
                });

                const data = await response.json();
                document.getElementById('totalBanks').textContent = data.records.length;
                
                if (data.records.length > 0) {
                    // Find most recent update
                    let lastUpdate = null;
                    data.records.forEach(record => {
                        const updateDate = record.fields['Last Updated'];
                        if (updateDate && (!lastUpdate || updateDate > lastUpdate)) {
                            lastUpdate = updateDate;
                        }
                    });
                    
                    if (lastUpdate) {
                        document.getElementById('lastUpload').textContent = new Date(lastUpdate).toLocaleDateString();
                    }
                }
                
                document.getElementById('totalUploads').textContent = uploadHistory.length;
            } catch (error) {
                console.error('Error updating stats:', error);
            }
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            const messageDiv = document.getElementById('notificationMessage');
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 
                        'fa-info-circle';
            const color = type === 'success' ? '#28a745' : 
                         type === 'error' ? '#dc3545' : 
                         '#17a2b8';
            
            messageDiv.innerHTML = `
                <i class="fas ${icon}" style="color: ${color}; margin-right: 10px;"></i>
                ${message}
            `;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        function testWithSamplePDF() {
            alert('PDF Parser Test\n\n' +
                  'The universal parser can extract rates from any bank PDF that contains:\n\n' +
                  '1. Bank name in text\n' +
                  '2. Interest rates in percentage format (e.g., 3.50%)\n' +
                  '3. Rate descriptions (Savings, Fixed Deposit, etc.)\n\n' +
                  'For best results:\n' +
                  '• Name files: "BankName Month Year.pdf"\n' +
                  '• Use text-based PDFs (not scanned)\n' +
                  '• Upload one PDF at a time to test\n\n' +
                  'Example successful filenames:\n' +
                  '• "FNB Botswana March 2025.pdf"\n' +
                  '• "Bank Gaborone January 2025.pdf"\n' +
                  '• "Stanbic Rates April 2025.pdf"');
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.location.href = 'index.html';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            
            // Load any saved upload history from localStorage
            const savedHistory = localStorage.getItem('uploadHistory');
            if (savedHistory) {
                try {
                    uploadHistory = JSON.parse(savedHistory);
                    updateUploadTable();
                } catch (e) {
                    console.error('Error loading upload history:', e);
                }
            }
            
            // Save upload history to localStorage
            setInterval(() => {
                localStorage.setItem('uploadHistory', JSON.stringify(uploadHistory));
            }, 5000);
        });
    </script>
</body>
</html>